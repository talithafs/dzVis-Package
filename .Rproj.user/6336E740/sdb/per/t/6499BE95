{
    "contents" : "#' @title Import data from the dzVis database\n#'\n#' @description Gets data from the dzVis database according to the specified table and columns.\n#'              Original column types are set to its equivalents in R.\n#'\n#' @param table A \\code{character}. The name of the table.\n#' @param columns A \\code{character vector}. The name(s) of the column(s). If all columns should be imported, this argument must be set to \\code{*}.\n#' @param restrictions A n x 2 \\code{matrix}. Equality restrictions. The first column must contain the names of the columns. The second, its values.\n#' @param limits A n x 3 \\code{matrix}. Inequality restrictions. See the details section for important information.\n#' @param connection A \\code{DBI} Connection object if a new connection should not be estabilished.\n#'\n#' @return A \\code{data.frame} with the requested data.\n#'\n#' @details The \\code{limits} matrix must have the following columns\n#' \\enumerate{\n#'    \\item targetColumn: A \\code{character} value. Column on which restrictions should apply.\n#'    \\item min: A \\code{numeric} value. Lower bound for the \\code{targetColumn}. Should be set to \\code{NA} when not applicable.\n#'    \\item max: A \\code{numeric} value. Upper bound for the \\code{targetColumn}. Should be set to \\code{NA} when not applicable.\n#' }\n#'\n#' @section Conversion rules (SQL -> R):\n#' \\enumerate{\n#'    \\item \\code{enum} -> \\code{factor}\n#'    \\item \\code{int} -> \\code{integer}\n#'    \\item \\code{double} -> \\code{numeric}\n#'    \\item \\code{date} or \\code{datetime} -> \\code{Date}\n#'    \\item \\code{varchar} -> \\code{character}\n#' }\n#'\n#' @import DBI\n\n\nimportData <- function(table, columns, restrictions = NULL, limits = NULL, connection = NULL){\n\n  conn <- connection\n\n  if(is.null(connection)){\n    conn <- connect()\n  }\n\n  cols <- paste(columns,collapse = \", \")\n  query <- paste(\"select\",cols,\"from\",table)\n\n  if(!is.null(restrictions) && !is.null(limits)) {\n    query <- pasteIdRestrictions(query, restrictions)\n    query <- pasteLimitRestrictions(query, limits, whereClause = FALSE)\n  }\n  else if(!is.null(limits)) {\n    query <- pasteLimitRestrictions(query, limits)\n  }\n  else if(!is.null(restrictions)){\n    query <- pasteIdRestrictions(query, restrictions)\n  }\n\n  print(query)\n\n  data <- dbGetQuery(conn, query)\n  types <- getDataTypes(table, columns, conn)\n\n  for(colName in names(data)){\n    type = types[types$cod == colName,2]\n\n    if(type == \"enum\"){\n        data[,colName] <- as.factor(data[,colName])\n    }\n    else if(type == \"int\"){\n      data[,colName] <- as.integer(data[,colName])\n    }\n    else if(type == \"double\"){\n      data[,colName] <- as.numeric(data[,colName])\n\n    }\n    else if(type == \"date\" || type == \"datetime\"){\n      data[,colName] <- as.Date(data[,colName])\n    }\n    else if(type == \"varchar\"){\n      data[,colName] <- as.character(data[,colName])\n    }\n  }\n\n  if(is.null(connection)) {\n    disconnect(conn)\n  }\n\n  return(data)\n\n}\n\n\n\n",
    "created" : 1453941031332.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3858889197",
    "id" : "6499BE95",
    "lastKnownWriteTime" : 1453941070,
    "path" : "C:/Users/Talitha/Dropbox/Economia/Projeto Final/R Package/dzVis/R/importData.R",
    "project_path" : "R/importData.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}